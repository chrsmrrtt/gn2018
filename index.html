<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Christopher Marriott's Overly Complicated Grand National Sweepstake, 2018</title>
    <link rel="stylesheet" type="text/css" href="reset.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:300,300i,700&amp;subset=latin-ext" rel="stylesheet">
    <script src="jquery.js"></script>
    <script>
      var horses = [
        {number: 1, name: "Alice", odds: 10},
        {number: 2, name: "Bob", odds: 20},
        {number: 3, name: "Cheryl", odds: 30},
        {number: 4, name: "Daniel", odds: 40},
        {number: 5, name: "Emma", odds: 50},
        {number: 6, name: "Fred", odds: 50},
        {number: 7, name: "Gloria", odds: 50},
        {number: 8, name: "Henry", odds: 60},
        {number: 9, name: "Irene", odds: 70},
        {number: 10, name: "Jack", odds: 80},
        {number: 11, name: "Karen", odds: 90},
        {number: 12, name: "Lee", odds: 100},
        {number: 13, name: "Marge", odds: 11},
        {number: 14, name: "Neil", odds: 21},
        {number: 15, name: "Olga", odds: 31},
        {number: 16, name: "Pete", odds: 41},
        {number: 17, name: "Quinn", odds: 51},
        {number: 18, name: "Robert", odds: 61},
        {number: 19, name: "Sally", odds: 71},
        {number: 20, name: "Trevor", odds: 81},
        {number: 21, name: "Una", odds: 91},
        {number: 22, name: "Victor", odds: 101},
        {number: 23, name: "Wendy", odds: 12},
        {number: 24, name: "Xavier", odds: 22},
        {number: 25, name: "Yolande", odds: 32},
        {number: 26, name: "Zack", odds: 42},
        {number: 27, name: "Albania", odds: 52},
        {number: 28, name: "Brazil", odds: 62},
        {number: 29, name: "Cuba", odds: 72},
        {number: 30, name: "Denmark", odds: 82},
        {number: 31, name: "Ecuador", odds: 92},
        {number: 32, name: "Finland", odds: 102},
        {number: 33, name: "Greece", odds: 13},
        {number: 34, name: "Hungary", odds: 23},
        {number: 35, name: "Iran", odds: 33},
        {number: 36, name: "Japan", odds: 43},
        {number: 37, name: "Kenya", odds: 53},
        {number: 38, name: "Laos", odds: 63},
        {number: 39, name: "Mali", odds: 73},
        {number: 40, name: "Niger", odds: 83}
      ];
      
      var keyframe_speed = 2000;
      var fade_speed = 500;

      function random_horses(n) {
          var shuffled = horses.slice(0), i = horses.length, temp, index;
          while (i--) {
              index = Math.floor((i + 1) * Math.random());
              temp = shuffled[index];
              shuffled[index] = shuffled[i];
              shuffled[i] = temp;
          }
          return shuffled.slice(0, n);
      }

      function create_list_node(number, name, odds) {
          var li = document.createElement("li");
          li.setAttribute("style", "display: none;");
          li.innerHTML = "<span class='number'>#" + number + "</span> <span class='name'>&quot;" + name + "&quot;</span> <span class='odds'>@ " + odds + "-to-1</span>";
          return li;
      }

      function reveal() {
          $("button").hide();
          $("input").attr("readonly", "readonly")

          var entry_horses = random_horses(10);

          var list = $("ul#entry");
          var ta = $("#output");
          var entrant = $("#name").val();

          entry_horses.forEach(function(horse){
              var li_node = create_list_node(horse.number, horse.name, horse.odds);
              $(list).append(li_node);
              $(ta).append(document.createTextNode(horse.number + "\t"));
          });

          $("ul#entry li").each(function(index) {
              $(this).delay(keyframe_speed*index).fadeIn(fade_speed);
          });
          
          var gl_node = document.createElement("li");
          gl_node.setAttribute("style", "display: none;");
          gl_node.setAttribute("class", "gl");
          gl_node.textContent = "Good luck!";
          $(list).append(gl_node);
          $(gl_node).delay(keyframe_speed*10).fadeIn(fade_speed);
          
          $("#data").delay(keyframe_speed*10).fadeIn(fade_speed);

          $(ta).text(entrant + "\t" + entry_horses.map(horse => horse.number).join("\t"));
      }
      
      function showData() {
        window.prompt("Copy and paste to Google Sheet", document.querySelector("#output").value);
      }
    </script>
    <style>
    
      *, html, body {
        font-size: 100%;
        font-family: "Open Sans Condensed";
        font-weight: 700;
      }

      #container {
        max-width: 31em;
        margin: auto;
        margin-top: 0.5em;
        text-align: center;
        font-size: 24pt;
      }

      h1 {
        font-size: 32pt;
        text-transform: uppercase;
        color: #005346;
        margin-bottom: 0.5em;
      }

      #pick-button {
        padding: 0.5em 2em;
        text-transform: uppercase;
        background-color: #bf0019;
        font-size: 24px;
        color: #ffffff;
        border-radius: 5px;
        border: none;
        margin-bottom: 1em;
      }

      ul {
        list-style-type: none;
        padding-left: 0px;
      }

      li {
        margin-bottom: 0.5em;
        font-size: 16pt;
      }

      #name {
        font-size: 16pt;
        width: 20em;
        background-color: #ffffdd;
        text-align: center;
        margin-bottom: 1em;
      }
      
      .gl {
        margin-top: 1em;
        color: #bf0019;
      }
      
      #data {
        padding: 0.5em 0.5em;
        text-transform: uppercase;
        background-color: #dddddd;
        font-size: 16px;
        color: #333333;
        border-radius: 5px;
        border: none;
        margin-bottom: 1em;
      }
      
      .number {
        color: #888888;
        font-size: 12pt;
      }
      
      .name {
      
      }
      
      .odds {
        color: #835300;
        font-size: 12pt;
      }
    </style>
  </head>
  <body>
    <div id="container">
      <h1>Christopher Marriott's<br />Overly Complicated<br />Grand National<br />Sweepstake, 2018</h1>
      <div><input id="name" type="text" placeholder="Entrant's name&hellip;" autocomplete="off" /></div>
      <div><button id="pick-button" type="button" onclick="reveal()">Pick horses</button></div>
      <ul id="entry"></ul>
      <textarea id="output" hidden></textarea>
      <button type="button" id="data" onclick="showData()" hidden>Get data</button>
    </div>
  </body>
</html>
